<!DOCTYPE html>
<html>
<head>
    <title>Test Powers</title>
    <script src="src/utils/powers.js"></script>
</head>
<body>
    <h1>Тест возведения степени в степень</h1>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');

        function test(name, expr, expectedBase, expectedExp) {
            const result = expr.simplify();
            const resultTex = (typeof result === 'number') ? result : result.tex();

            let passed = false;
            let expectedTex = '';

            if (typeof expectedBase === 'number' && typeof expectedExp === 'number') {
                // Ожидаем степень: expectedBase^expectedExp
                expectedTex = `${expectedBase}^{${expectedExp}}`;
                passed = result instanceof Power &&
                         result.base === expectedBase &&
                         result.exponent === expectedExp &&
                         result.coefficient === 1;
            } else if (typeof expectedBase === 'number' && expectedExp === undefined) {
                // Ожидаем просто число
                expectedTex = expectedBase.toString();
                passed = (typeof result === 'number' && result === expectedBase);
            }

            results.innerHTML += `
                <div style="margin: 10px; padding: 10px; border: 1px solid ${passed ? 'green' : 'red'}">
                    <strong>${name}</strong><br>
                    Выражение: ${expr.tex()}<br>
                    Результат: ${resultTex}<br>
                    Ожидалось: ${expectedTex}<br>
                    Статус: ${passed ? '✓ PASS' : '✗ FAIL'}
                </div>
            `;
        }

        // Тест 1: (2^3)^2 = 2^6
        const test1 = new Power(new Power(2, 3), 2);
        test('(2^3)^2 = 2^6', test1, 2, 6);

        // Тест 2: (2^2)^3 = 2^6
        const test2 = new Power(new Power(2, 2), 3);
        test('(2^2)^3 = 2^6', test2, 2, 6);

        // Тест 3: 2^3 * 2^2 = 2^5
        const test3 = new Multiplication(new Power(2, 3), new Power(2, 2));
        test('2^3 * 2^2 = 2^5', test3, 2, 5);

        // Тест 4: 2^5 / 2^2 = 2^3
        const test4 = new Division(new Power(2, 5), new Power(2, 2));
        test('2^5 / 2^2 = 2^3', test4, 2, 3);

        // Тест 5: Проверка умножения чисел через Multiplication
        const test5 = new Multiplication(3, 2);
        const result5 = test5.simplify();
        results.innerHTML += `
            <div style="margin: 10px; padding: 10px; border: 1px solid ${result5 === 6 ? 'green' : 'red'}">
                <strong>Multiplication(3, 2).simplify() = 6</strong><br>
                Результат: ${result5}<br>
                Ожидалось: 6<br>
                Статус: ${result5 === 6 ? '✓ PASS' : '✗ FAIL'}
            </div>
        `;

        // Тест 6: (2^3)^2 * 2^1 = 2^7
        const test6 = new Multiplication(new Power(new Power(2, 3), 2), new Power(2, 1));
        test('(2^3)^2 * 2^1 = 2^7', test6, 2, 7);

        // Тест 7: ((2^2)^2)^2 = 2^8
        const test7 = new Power(new Power(new Power(2, 2), 2), 2);
        test('((2^2)^2)^2 = 2^8', test7, 2, 8);
    </script>
</body>
</html>
